# Vulnerability Result Endpoints

## Description
Resources and operations for retrieving vulnerability results on assessed assets.

This document contains 7 endpoints under the Vulnerability Result tag.

---

## 1. Asset Service Vulnerabilities

# Asset Service Vulnerabilities

**Endpoint:** `GET /api/3/assets/{id}/services/{protocol}/{port}/vulnerabilities`

## Description
Retrieves the vulnerabilities present on a service running on an asset. A finding may be `invulnerable` if all instances on the service have exceptions applied.

**Operation ID:** `getAssetServiceVulnerabilities`

## Parameters

### Parameter 1
**Name:** `id`
**Location:** path
**Type:** integer
**Required:** Yes
**Description:** The identifier of the asset.

### Parameter 2
**Name:** `protocol`
**Location:** path
**Type:** string
**Required:** Yes
**Description:** The protocol of the service.

### Parameter 3
**Name:** `port`
**Location:** path
**Type:** integer
**Required:** Yes
**Description:** The port of the service.

### Parameter 4
**Name:** `page`
**Location:** query
**Type:** integer
**Required:** No
**Description:** The index of the page (zero-based) to retrieve.

### Parameter 5
**Name:** `size`
**Location:** query
**Type:** integer
**Required:** No
**Description:** The number of records per page to retrieve.

### Parameter 6
**Name:** `sort`
**Location:** query
**Type:** array
**Required:** No
**Description:** The criteria to sort the records by, in the format: `property[,ASC|DESC]`. The default sort order is ascending. Multiple sort criteria can be specified using multiple sort query parameters.

## Responses

### 200
**Description:** OK
**Schema:** `PageOf«VulnerabilityFinding»`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "page": {
    "number": 6,
    "size": 10,
    "totalPages": 13,
    "totalResources": 123
  },
  "resources": [
    {
      "id": "ssh-openssh-x11uselocalhost-x11-forwarding-session-hijack",
      "instances": 1,
      "links": [
        {
          "href": "https://hostname:3780/api/3/...",
          "rel": "self"
        }
      ],
      "results": [
        {
          "checkId": "ssh-openssh-x11uselocalhost-x11-forwarding-session-hijack",
          "exceptions": [
            42
          ],
          "key": "",
          "links": [
            {
              "href": "https://hostname:3780/api/3/...",
              "rel": "self"
            }
          ],
          "port": 22,
          "proof": "<p><p>OpenBSD OpenSSH 4.3 on Linux</p></p>",
          "protocol": "tcp",
          "since": "2017-08-09T11:32:33.658Z",
          "status": "vulnerable-version"
        }
      ],
      "since": "2017-08-09T11:32:33.658Z",
      "status": "vulnerable"
    }
  ]
}
```

### 401
**Description:** Unauthorized
**Schema:** `UnauthorizedError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "401"
}
```

### 404
**Description:** Not Found
**Schema:** `NotFoundError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "404"
}
```

### 500
**Description:** Internal Server Error
**Schema:** `InternalServerError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "500"
}
```

### 503
**Description:** Service Unavailable
**Schema:** `ServiceUnavailableError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "503"
}
```

## Request Content-Type
- `application/json`

## Response Content-Type
- `application/json;charset=UTF-8`


---

## 2. Asset Vulnerabilities

# Asset Vulnerabilities

**Endpoint:** `GET /api/3/assets/{id}/vulnerabilities`

## Description
Retrieves all vulnerability findings on an asset. A finding may be `invulnerable` if all instances have exceptions applied.

**Operation ID:** `getAssetVulnerabilities`

## Parameters

### Parameter 1
**Name:** `id`
**Location:** path
**Type:** integer
**Required:** Yes
**Description:** The identifier of the asset.

### Parameter 2
**Name:** `page`
**Location:** query
**Type:** integer
**Required:** No
**Description:** The index of the page (zero-based) to retrieve.

### Parameter 3
**Name:** `size`
**Location:** query
**Type:** integer
**Required:** No
**Description:** The number of records per page to retrieve.

### Parameter 4
**Name:** `sort`
**Location:** query
**Type:** array
**Required:** No
**Description:** The criteria to sort the records by, in the format: `property[,ASC|DESC]`. The default sort order is ascending. Multiple sort criteria can be specified using multiple sort query parameters.

## Responses

### 200
**Description:** OK
**Schema:** `PageOf«VulnerabilityFinding»`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "page": {
    "number": 6,
    "size": 10,
    "totalPages": 13,
    "totalResources": 123
  },
  "resources": [
    {
      "id": "ssh-openssh-x11uselocalhost-x11-forwarding-session-hijack",
      "instances": 1,
      "links": [
        {
          "href": "https://hostname:3780/api/3/...",
          "rel": "self"
        }
      ],
      "results": [
        {
          "checkId": "ssh-openssh-x11uselocalhost-x11-forwarding-session-hijack",
          "exceptions": [
            42
          ],
          "key": "",
          "links": [
            {
              "href": "https://hostname:3780/api/3/...",
              "rel": "self"
            }
          ],
          "port": 22,
          "proof": "<p><p>OpenBSD OpenSSH 4.3 on Linux</p></p>",
          "protocol": "tcp",
          "since": "2017-08-09T11:32:33.658Z",
          "status": "vulnerable-version"
        }
      ],
      "since": "2017-08-09T11:32:33.658Z",
      "status": "vulnerable"
    }
  ]
}
```

### 401
**Description:** Unauthorized
**Schema:** `UnauthorizedError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "401"
}
```

### 404
**Description:** Not Found
**Schema:** `NotFoundError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "404"
}
```

### 500
**Description:** Internal Server Error
**Schema:** `InternalServerError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "500"
}
```

### 503
**Description:** Service Unavailable
**Schema:** `ServiceUnavailableError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "503"
}
```

## Request Content-Type
- `application/json`

## Response Content-Type
- `application/json;charset=UTF-8`


---

## 3. Asset Vulnerability

# Asset Vulnerability

**Endpoint:** `GET /api/3/assets/{id}/vulnerabilities/{vulnerabilityId}`

## Description
Retrieves the details for a vulnerability finding on an asset.

**Operation ID:** `getAssetVulnerability`

## Parameters

### Parameter 1
**Name:** `id`
**Location:** path
**Type:** integer
**Required:** Yes
**Description:** The identifier of the asset.

### Parameter 2
**Name:** `vulnerabilityId`
**Location:** path
**Type:** string
**Required:** Yes
**Description:** The identifier of the vulnerability.

## Responses

### 200
**Description:** OK
**Schema:** `VulnerabilityFinding`
**Example JSON Response:**
```json
{
  "id": "ssh-openssh-x11uselocalhost-x11-forwarding-session-hijack",
  "instances": 1,
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "results": [
    {
      "checkId": "ssh-openssh-x11uselocalhost-x11-forwarding-session-hijack",
      "exceptions": [
        42
      ],
      "key": "",
      "links": [
        {
          "href": "https://hostname:3780/api/3/...",
          "rel": "self"
        }
      ],
      "port": 22,
      "proof": "<p><p>OpenBSD OpenSSH 4.3 on Linux</p></p>",
      "protocol": "tcp",
      "since": "2017-08-09T11:32:33.658Z",
      "status": "vulnerable-version"
    }
  ],
  "since": "2017-08-09T11:32:33.658Z",
  "status": "vulnerable"
}
```

### 401
**Description:** Unauthorized
**Schema:** `UnauthorizedError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "401"
}
```

### 404
**Description:** Not Found
**Schema:** `NotFoundError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "404"
}
```

### 500
**Description:** Internal Server Error
**Schema:** `InternalServerError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "500"
}
```

### 503
**Description:** Service Unavailable
**Schema:** `ServiceUnavailableError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "503"
}
```

## Request Content-Type
- `application/json`

## Response Content-Type
- `application/json;charset=UTF-8`


---

## 4. Asset Vulnerability Validations

# Asset Vulnerability Validations

**Endpoint:** `GET /api/3/assets/{id}/vulnerabilities/{vulnerabilityId}/validations`

## Description
Returns all vulnerability validations for a vulnerability on an asset. The asset must be currently vulnerable to the validated vulnerable for the validation to be returned.

**Operation ID:** `getVulnerabilityValidations`

## Parameters

### Parameter 1
**Name:** `id`
**Location:** path
**Type:** integer
**Required:** Yes
**Description:** The identifier of the asset.

### Parameter 2
**Name:** `vulnerabilityId`
**Location:** path
**Type:** string
**Required:** Yes
**Description:** The identifier of the vulnerability.

## Responses

### 200
**Description:** OK
**Schema:** `Resources«VulnerabilityValidationResource»`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "resources": [
    {
      "date": "2017-12-21T04:54:32.314Z",
      "id": 46,
      "links": [
        {
          "href": "https://hostname:3780/api/3/...",
          "rel": "self"
        }
      ],
      "source": {
        "key": "exploit/windows/iis/iis_webdav_scstoragepathfromurl",
        "name": "metasploit"
      }
    }
  ]
}
```

### 401
**Description:** Unauthorized
**Schema:** `UnauthorizedError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "401"
}
```

### 404
**Description:** Not Found
**Schema:** `NotFoundError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "404"
}
```

### 500
**Description:** Internal Server Error
**Schema:** `InternalServerError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "500"
}
```

### 503
**Description:** Service Unavailable
**Schema:** `ServiceUnavailableError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "503"
}
```

## Request Content-Type
- `application/json`

## Response Content-Type
- `application/json;charset=UTF-8`


---

## 5. Asset Vulnerability Validations

# Asset Vulnerability Validations

**Endpoint:** `POST /api/3/assets/{id}/vulnerabilities/{vulnerabilityId}/validations`

## Description
Creates a vulnerability validation for a vulnerability on an asset. The validation signifies that the vulnerability has been confirmed exploitable by an external tool, such as Metasploit.

**Operation ID:** `createVulnerabilityValidation`

## Parameters

### Parameter 1
**Name:** `id`
**Location:** path
**Type:** integer
**Required:** Yes
**Description:** The identifier of the asset.

### Parameter 2
**Name:** `vulnerabilityId`
**Location:** path
**Type:** string
**Required:** Yes
**Description:** The identifier of the vulnerability.

### Parameter 3
**Name:** `validation`
**Location:** body
**Type:** VulnerabilityValidationResource
**Required:** No
**Description:** A vulnerability validation for a vulnerability on an asset. The validation signifies that the vulnerability has been confirmed exploitable by an external tool, such as Metasploit.
**JSON Example:**
```json
{
  "date": "2017-12-21T04:54:32.314Z",
  "id": 46,
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "source": {
    "key": "exploit/windows/iis/iis_webdav_scstoragepathfromurl",
    "name": "metasploit"
  }
}
```

## Request Body
**Name:** `validation`
**Location:** body
**Type:** VulnerabilityValidationResource
**Required:** No
**Description:** A vulnerability validation for a vulnerability on an asset. The validation signifies that the vulnerability has been confirmed exploitable by an external tool, such as Metasploit.
**JSON Example:**
```json
{
  "date": "2017-12-21T04:54:32.314Z",
  "id": 46,
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "source": {
    "key": "exploit/windows/iis/iis_webdav_scstoragepathfromurl",
    "name": "metasploit"
  }
}
```

## Responses

### 200
**Description:** OK
**Schema:** `CreatedReference«VulnerabilityValidationID,Link»`
**Example JSON Response:**
```json
{
  "id": 1,
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ]
}
```

### 400
**Description:** Bad Request
**Schema:** `BadRequestError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "400"
}
```

### 401
**Description:** Unauthorized
**Schema:** `UnauthorizedError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "401"
}
```

### 500
**Description:** Internal Server Error
**Schema:** `InternalServerError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "500"
}
```

### 503
**Description:** Service Unavailable
**Schema:** `ServiceUnavailableError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "503"
}
```

## Request Content-Type
- `application/json`

## Response Content-Type
- `application/json;charset=UTF-8`


---

## 6. Asset Vulnerability Validation

# Asset Vulnerability Validation

**Endpoint:** `GET /api/3/assets/{id}/vulnerabilities/{vulnerabilityId}/validations/{validationId}`

## Description
Returns a vulnerability validation for a vulnerability on an asset. The asset must be currently vulnerable to the validated vulnerable for the validation to be returned.

**Operation ID:** `getVulnerabilityValidation`

## Parameters

### Parameter 1
**Name:** `id`
**Location:** path
**Type:** integer
**Required:** Yes
**Description:** The identifier of the asset.

### Parameter 2
**Name:** `vulnerabilityId`
**Location:** path
**Type:** string
**Required:** Yes
**Description:** The identifier of the vulnerability.

### Parameter 3
**Name:** `validationId`
**Location:** path
**Type:** integer
**Required:** Yes
**Description:** The identifier of the vulnerability validation.

## Responses

### 200
**Description:** OK
**Schema:** `VulnerabilityValidationResource`
**Example JSON Response:**
```json
{
  "date": "2017-12-21T04:54:32.314Z",
  "id": 46,
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "source": {
    "key": "exploit/windows/iis/iis_webdav_scstoragepathfromurl",
    "name": "metasploit"
  }
}
```

### 401
**Description:** Unauthorized
**Schema:** `UnauthorizedError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "401"
}
```

### 404
**Description:** Not Found
**Schema:** `NotFoundError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "404"
}
```

### 500
**Description:** Internal Server Error
**Schema:** `InternalServerError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "500"
}
```

### 503
**Description:** Service Unavailable
**Schema:** `ServiceUnavailableError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "503"
}
```

## Request Content-Type
- `application/json`

## Response Content-Type
- `application/json;charset=UTF-8`


---

## 7. Asset Vulnerability Validation

# Asset Vulnerability Validation

**Endpoint:** `DELETE /api/3/assets/{id}/vulnerabilities/{vulnerabilityId}/validations/{validationId}`

## Description
Removes a vulnerability validation for a vulnerability from an asset.

**Operation ID:** `deleteVulnerabilityValidation`

## Parameters

### Parameter 1
**Name:** `id`
**Location:** path
**Type:** integer
**Required:** Yes
**Description:** The identifier of the asset.

### Parameter 2
**Name:** `vulnerabilityId`
**Location:** path
**Type:** string
**Required:** Yes
**Description:** The identifier of the vulnerability.

### Parameter 3
**Name:** `validationId`
**Location:** path
**Type:** integer
**Required:** Yes
**Description:** The identifier of the vulnerability validation.

## Responses

### 200
**Description:** OK
**Schema:** `Links`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ]
}
```

### 401
**Description:** Unauthorized
**Schema:** `UnauthorizedError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "401"
}
```

### 404
**Description:** Not Found
**Schema:** `NotFoundError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "404"
}
```

### 500
**Description:** Internal Server Error
**Schema:** `InternalServerError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "500"
}
```

### 503
**Description:** Service Unavailable
**Schema:** `ServiceUnavailableError`
**Example JSON Response:**
```json
{
  "links": [
    {
      "href": "https://hostname:3780/api/3/...",
      "rel": "self"
    }
  ],
  "message": "An error has occurred.",
  "status": "503"
}
```

## Request Content-Type
- `application/json`

## Response Content-Type
- `application/json;charset=UTF-8`


---
